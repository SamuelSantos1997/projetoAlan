<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Perfil</title>
  <link rel="stylesheet" href="./perfil.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/assets/css/base.css">
</head>
<body>
  <div id="navbar"></div>
  <main class="container">
    <header class="header">
      <div class="header-top">
        <div>
          <h1>Meu perfil</h1>
          <p class="subtitle">Gerencie sua foto e seus dados pessoais</p>
          <p id="statusCarregando" class="subtitle" style="color:#9aa3b2;font-size:12px;">Carregando perfil...</p>
        </div>
        <button class="btn btn-logout" type="button" id="btnLogout">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
            <polyline points="16 17 21 12 16 7"></polyline>
            <line x1="21" y1="12" x2="9" y2="12"></line>
          </svg>
          Sair
        </button>
      </div>
    </header>

    <section class="card">
      <div class="avatar-block">
        <div class="avatar">
          <img id="avatarPreview" src="./img/avatar-placeholder.svg" alt="Foto do perfil" />
        </div>
        <div class="avatar-actions">
          <label class="btn" for="avatarInput">Adicionar/Alterar foto</label>
          <input id="avatarInput" type="file" accept="image/*" hidden />
          <button id="removerFoto" class="btn btn-secondary" type="button">Remover</button>
        </div>
        <p class="hint">PNG/JPG até 5MB. A imagem será recortada para formato circular.</p>
      </div>

      <form id="perfilForm" class="form">
        <div class="grid">
          <div class="field">
            <label for="nomeCompleto">Nome completo</label>
            <input id="nomeCompleto" name="nomeCompleto" type="text" placeholder="Seu nome e sobrenome" required />
          </div>

          <div class="field">
            <label for="email">Email</label>
            <input id="email" name="email" type="email" placeholder="voce@exemplo.com" required />
            <span id="emailError" class="field-error"></span>
          </div>

          <div class="field">
            <label for="telefone">Telefone</label>
            <input id="telefone" name="telefone" type="tel" placeholder="(00) 00000-0000" />
          </div>

          <div class="field">
            <label for="cpf">CPF</label>
            <input id="cpf" name="cpf" type="text" inputmode="numeric" placeholder="000.000.000-00" maxlength="14" />
            <span id="cpfError" class="field-error"></span>
          </div>

          <div class="field field-full">
            <label for="endereco">Endereço</label>
            <input id="endereco" name="endereco" type="text" placeholder="Rua, número, complemento, bairro, cidade/UF" />
          </div>

          <div class="field">
            <label for="dataNascimento">Data de nascimento</label>
            <input id="dataNascimento" name="dataNascimento" type="date" />
          </div>

          <div class="field field-premium">
            <label>Status do Plano</label>
            <div class="premium-status">
              <span id="premiumBadge" class="premium-badge-inactive">Grátis</span>
              <span id="premiumAteText" class="premium-ate"></span>
              <a href="/views/premium/index.html" class="premium-link" id="premiumLink">Gerenciar plano</a>
            </div>
          </div>
        </div>

        <div class="actions">
          <button class="btn btn-secondary" type="button" id="btnReset">Cancelar</button>
          <button class="btn" type="submit" id="btnSalvar">Salvar alterações</button>
        </div>
      </form>
    </section>

    <!-- Seção de Alterar Senha -->
    <section class="card card-senha">
      <h2 class="card-title">Alterar Senha</h2>
      <p class="card-subtitle">Para alterar sua senha, preencha os campos abaixo</p>

      <form id="senhaForm" class="form">
        <div class="grid">
          <div class="field field-full">
            <label for="senhaAtual">Senha atual</label>
            <div class="password-input-wrapper">
              <input id="senhaAtual" name="senhaAtual" type="password" placeholder="Digite sua senha atual" required />
              <button type="button" class="toggle-password" data-target="senhaAtual">
                <svg class="eye-open" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                  <circle cx="12" cy="12" r="3"></circle>
                </svg>
                <svg class="eye-closed" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display:none;">
                  <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path>
                  <line x1="1" y1="1" x2="23" y2="23"></line>
                </svg>
              </button>
            </div>
          </div>

          <div class="field">
            <label for="novaSenha">Nova senha</label>
            <div class="password-input-wrapper">
              <input id="novaSenha" name="novaSenha" type="password" placeholder="Mínimo 8 caracteres" required />
              <button type="button" class="toggle-password" data-target="novaSenha">
                <svg class="eye-open" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                  <circle cx="12" cy="12" r="3"></circle>
                </svg>
                <svg class="eye-closed" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display:none;">
                  <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path>
                  <line x1="1" y1="1" x2="23" y2="23"></line>
                </svg>
              </button>
            </div>
            <span id="novaSenhaError" class="field-error"></span>
          </div>

          <div class="field">
            <label for="confirmarSenha">Confirmar nova senha</label>
            <div class="password-input-wrapper">
              <input id="confirmarSenha" name="confirmarSenha" type="password" placeholder="Repita a nova senha" required />
              <button type="button" class="toggle-password" data-target="confirmarSenha">
                <svg class="eye-open" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                  <circle cx="12" cy="12" r="3"></circle>
                </svg>
                <svg class="eye-closed" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display:none;">
                  <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path>
                  <line x1="1" y1="1" x2="23" y2="23"></line>
                </svg>
              </button>
            </div>
            <span id="confirmarSenhaError" class="field-error"></span>
          </div>

          <div class="field field-full">
            <div class="password-requirements">
              <p class="requirements-title">A senha deve conter:</p>
              <ul class="requirements-list">
                <li id="req-length" class="requirement">Mínimo 8 caracteres</li>
                <li id="req-upper" class="requirement">Uma letra maiúscula</li>
                <li id="req-lower" class="requirement">Uma letra minúscula</li>
                <li id="req-number" class="requirement">Um número</li>
                <li id="req-special" class="requirement">Um caractere especial (!@#$%^&*)</li>
              </ul>
            </div>
          </div>
        </div>

        <div class="actions">
          <button class="btn" type="submit" id="btnAlterarSenha">Alterar senha</button>
        </div>
      </form>
    </section>

    <!-- Seção Zona de Perigo -->
    <section class="card card-danger">
      <h2 class="card-title danger-title">Zona de Perigo</h2>
      <p class="card-subtitle">Ações irreversíveis para sua conta</p>

      <div class="danger-content">
        <div class="danger-info">
          <h3>Excluir minha conta</h3>
          <p>Ao excluir sua conta, todos os seus dados serão permanentemente removidos, incluindo:</p>
          <ul>
            <li>Dados pessoais e perfil</li>
            <li>Histórico de treinos</li>
            <li>Histórico de pagamentos</li>
            <li>Conversas e mensagens</li>
          </ul>
          <p class="danger-warning">Esta ação é irreversível e não pode ser desfeita.</p>
        </div>
        <button class="btn btn-danger" type="button" id="btnExcluirConta">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="3 6 5 6 21 6"></polyline>
            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
            <line x1="10" y1="11" x2="10" y2="17"></line>
            <line x1="14" y1="11" x2="14" y2="17"></line>
          </svg>
          Excluir minha conta
        </button>
      </div>
    </section>

    <!-- Modal de Confirmação -->
    <div id="modalExcluirConta" class="modal" hidden>
      <div class="modal-backdrop"></div>
      <div class="modal-content">
        <h2 class="modal-title">Confirmar exclusão de conta</h2>
        <p class="modal-text">Você está prestes a excluir permanentemente sua conta. Esta ação não pode ser desfeita.</p>
        <p class="modal-text">Para confirmar, digite sua senha:</p>
        <div class="field">
          <div class="password-input-wrapper">
            <input id="senhaConfirmacao" type="password" placeholder="Digite sua senha" />
            <button type="button" class="toggle-password" data-target="senhaConfirmacao">
              <svg class="eye-open" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                <circle cx="12" cy="12" r="3"></circle>
              </svg>
              <svg class="eye-closed" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display:none;">
                <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path>
                <line x1="1" y1="1" x2="23" y2="23"></line>
              </svg>
            </button>
          </div>
        </div>
        <div class="modal-actions">
          <button class="btn btn-secondary" type="button" id="btnCancelarExclusao">Cancelar</button>
          <button class="btn btn-danger" type="button" id="btnConfirmarExclusao">Excluir permanentemente</button>
        </div>
      </div>
    </div>
  </main>

  <script src="/assets/js/config.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@stomp/stompjs@7/bundles/stomp.umd.min.js"></script>
  <script src="/assets/js/presenca.js"></script>
  <script src="./perfil.js"></script>
  <script src="/assets/js/injectNavbar.js"></script>
</body>
</html>
